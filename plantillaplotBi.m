clear A Xall Zall f f_plot

A=[0.3500   0.15000     0.895302873728858    2.984730838215565
0.2500   0.15000     1.837067320446946    6.312238869062647
0.1500   0.15000     3.399214620373811    11.181304292731543
0.0500   0.15000     6.748207771678341    38.402056698964323
0.0000   0.15000     16.747740917915067   NaN
0.3000   0.1000      1.654443796558647    5.946991821286050
0.2000   0.1000      4.164622036670355    14.597438445465594
0.1000   0.1000      8.415095033835259    33.937627710577338
0.0000   0.1000      26.158223678276791   NaN
0.3500   0.05000     1.589093221833913    5.383007409278071
0.2500   0.05000     4.204011424175675    17.777236273167727
0.1500   0.05000     13.254618416875163   50.289594805399183
0.0500   0.05000     21.782420811776781   129.982382648831560
0.0000   0.05000     61.830685344457727   NaN];




Xall (:,:,1) =[   0.3500   0.3500
   0.2500   0.2500
   0.1500   0.1500
   0.0500   0.0500
        0   0.3000
   0.3000   0.2000
   0.2000   0.1000
   0.1000   0.3500
        0   0.2500
   0.3500   0.1500
   0.2500   0.0500];

Xall (:,:,2) =[ 0.1500   0.1500
   0.1500   0.1500
   0.1500   0.1500
   0.1500   0.1500
   0.1500   0.1000
   0.1000   0.1000
   0.1000   0.1000
   0.1000   0.0500
   0.1000   0.0500
   0.0500   0.0500
   0.0500   0.0500
];

Zall =[  0.8953     2.9847
     1.8371     6.3122
     3.3992    11.1813
     6.7482    38.4021
    16.7477     5.9470
     1.6544    14.5974
     4.1646    33.9376
     8.4151     5.3830
    26.1582    17.7772
     1.5891    50.2896
     4.2040   129.9824];



[X,Y]=meshgrid(Xall(:,2,1),Xall(:,2,1))



f =@(x, p) p (1) ./ (1 + p (2) .* x (:, 1) + p (3) .* x (:, 2) + p (4) .* x (:, 1) .* x (:, 2));

f_plot = @(p) p (1) ./ (1 + p (2) .* X + p (3) .* Y + p (4) .* X .* Y);

paramMatrix = [5.7811e+05  -7.3494e+02
   1.5828e+04   7.9751e+00
   4.1401e+05   1.9874e+00
   3.3157e+06  -3.2737e+03
   1.5463e+06  -9.5427e+02
   2.6867e+04   4.3682e+00
   5.2287e+05  -1.9188e+00
   1.6970e+07  -3.3701e+03
   1.8363e+00   1.4862e+00
   9.8488e-01   9.7914e-01];

   pos =[0   3 ];

Z=Y;
